% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/writeSWBMInputs.R
\name{SWBM_monthly_curtailment}
\alias{SWBM_monthly_curtailment}
\title{Add Monthly Curtailments to an Existing SWBM Curtailment Data Frame}
\usage{
SWBM_monthly_curtailment(
  curtailment_df,
  date_start,
  date_end,
  percent,
  field_list = NULL,
  field_shp = NULL,
  swbm_fields = file.path(data_dir["ref_data_dir", "loc"], "Landuse_20190219.shp"),
  min_overlap_pct = 0.05,
  verbose = TRUE
)
}
\arguments{
\item{curtailment_df}{A wide data frame produced by
\code{create_SWBM_curtailment_df()}. First column must be
\code{Stress_Period}; remaining columns are \code{ID_<fieldID>}.}

\item{date_start, date_end}{\code{Date}. Inclusive range of stress periods
(months) to which the curtailment is applied.}

\item{percent}{Numeric (0-1).  Scalar or vector of curtailment fractions.
Interpreted as "fraction of \emph{normal} irrigation that is curtailed".}

\item{field_list}{Optional character or numeric vector of field IDs
(\emph{without} the \code{"ID_"} prefix).  If supplied,
curtailment is limited to these fields.}

\item{field_shp}{Optional \code{sf} object \emph{or} path to a polygon
shapefile/GeoPackage defining the area(s) to be curtailed.  If present,
\code{field_list} is ignored.
\itemize{
\item If \code{field_shp} has a column named \code{percent}, those values
are used \emph{per polygon}.  Otherwise the scalar
\code{percent} argument is used.
\item The function reprojects \code{field_shp} to the CRS of
\code{swbm_fields}.
}}

\item{swbm_fields}{An \code{sf} layer of SWBM agricultural fields
(default \code{Landuse_20190219.shp} from \code{data_dir}).  Used only when
\code{field_shp} is supplied.}

\item{min_overlap_pct}{Numeric. Ignore overlaps smaller than this fraction
(\code{0.05} = 5 \%).  Spatial curtailments only.}

\item{verbose}{Logical; print progress messages?}
}
\value{
The updated \code{curtailment_df} (invisible).
}
\description{
Updates a \code{curtailment_df} by adding user-specified curtailments for the
given date range.  Three mutually-exclusive modes are supported:
\enumerate{
\item \strong{Global}: apply \code{percent} to \emph{every} field.
\item \strong{Field list}: apply (vectorised) \code{percent} to the specified
\code{field_list}.
\item \strong{Spatial}: intersect a polygon layer (\code{field_shp}) with the
SWBM field shapefile; per-field curtailment is
\code{overlap_fraction * percent_field}.
}
}
\examples{
\dontrun{
# 1) Curtail everything 20 \% July-September 2024:
curtailment_df <- SWBM_monthly_curtailment(
  curtailment_df,
  date_start = as.Date("2024-07-01"),
  date_end   = as.Date("2024-09-30"),
  percent    = 0.20
)

# 2) Curtail two fields by different amounts:
curtailment_df <- SWBM_monthly_curtailment(
  curtailment_df,
  date_start  = as.Date("2024-05-01"),
  date_end    = as.Date("2024-05-31"),
  field_list  = c("1234", "5678"),
  percent     = c(0.10, 0.25)
)

# 3) Spatial curtailment - polygon layer with its own 'percent' column:
curtailment_df <- SWBM_monthly_curtailment(
  curtailment_df,
  date_start   = as.Date("2023-04-01"),
  date_end     = as.Date("2023-10-31"),
  field_shp    = "path/to/2023_LCS_Fields_Clean.shp",
  min_overlap_pct = 0.05
)
}
}
